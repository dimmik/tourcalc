@page "/tour/{tourId}"
@using TCBlazor.Client.Utils
@using TCalc.Domain
@inject HttpClient Http
@inject TCBlazor.Client.Storage.TourcalcLocalStorage tourLocalStorage


<h3>Tour @TourId</h3>
Tour with id @TourId
@if (Tour == null)
{
    <span>Tour loading...</span>
}
else
{
    <div>
<!--Persons-->
<b id=@GetId("persons")>Persons</b>
<a href=@GetHref("spendings")>Spendings</a>
<TourPersonsComponent Tour=@Tour/>

<!--Spendings-->
<b id=@GetId("spendings")>Spendings</b>
<a href=@GetHref("persons")>Persons</a>
<TourSpendingsComponent Tour=@Tour/>

    </div>
}
<AnchorNavigation />
@code {
    [Parameter]
    public string? TourId { get; set; }

    public Tour? Tour = null;
    protected override async Task OnInitializedAsync()
    {
        var token = await tourLocalStorage.Get("__tc_token");
        Tour = await Http.GetFromJsonWithAuthToken<Tour>($"/api/Tour/{TourId}/suggested", token);
    }
    string GetId(string l) => $"{l}";
    string GetHref(string l) => $"/tour/{TourId}#" + GetId(l);
}
